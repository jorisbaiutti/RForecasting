---
title: "Documentation"
author: "Joris Baiutti"
date: "June 4, 2018"
output:
  html_document:
    df_print: paged
---



### Load stuff
```{r error=FALSE, warning=FALSE, message=FALSE}
library(Quandl)
library(ggplot2)
```

Api key: 1ywuwWFWbtaziA2GcaRU
```{r}
Quandl.api_key('1ywuwWFWbtaziA2GcaRU')
```

*Data*
https://www.quandl.com/data/EURONEXT-Euronext-Stock-Exchange


## Introduction
This document goes through a Monte Carlo Simulation of dtelekom, Intel and apple's closing stock prices.
\newpage


## Calculation of standard deviation and mean
For the standard deviation we collect the percentuel rate values. These values can be optained directly with quandle.
Then we can calculate standard deviation and mean of those rate values.

### dtelekom
#### Percentual rates
In this graph we can see the percentual daily rates over a year.
```{r}
dtelekomclosing = Quandl('EURONEXT/DTEL',start_date='2017-06-04', type='zoo',end_date='2018-06-04',transform = "rdiff")[,"Last"]
plot(dtelekomclosing,ylab="%",xlab="Time",main="dtelekom Stock in [%]")
dtelekomsd = sd(dtelekomclosing)
dtelekommean = mean(dtelekomclosing)
```

#### Arithmetic mean and stadard deviation
```{r}
dtelekommatrix = matrix(c(dtelekomsd,dtelekommean),ncol=2,byrow=TRUE)
colnames(dtelekommatrix) = c("Standard deviation","mean")
print.table(dtelekommatrix)
```
```{r }
dtelekom = Quandl('EURONEXT/DTEL', start_date='2017-06-04', end_date='2018-06-04')
ggplot(dtelekom, aes(Date, Last,)) + geom_line() + geom_smooth(method = "lm") + geom_smooth(method = "loess", color="Green") + labs(title="dtelekom closing Stock", y="Price in $", caption="Source: EURONEXT")
```

#### Brownian Motion

```{r}
nSim = 1000
nDays = 250
S0 = head(Quandl('EURONEXT/DTEL', start_date='2017-06-04', end_date='2018-06-04'), n=1)
S0 = S0$Last
S = matrix(0,nrow=nDays,ncol=nSim)
```
```{r}
for (i in 1:nSim) {
  SVec = rep(0, nDays)
  SVec[1] = S0
  for(j in 2:nDays) {
    pastDay = SVec[j-1]
    DeltaS = dtelekommean*pastDay + dtelekomsd*pastDay*rnorm(1)
    SVec[j] = pastDay+DeltaS
  }
  S[,i] = SVec
}


```

```{r}
# Calculation of simulation areas
mean = dtelekommean * nDays
sigma = dtelekomsd * sqrt(nDays)
t = seq(from=0,to=1,length.out=nDays)
meanBnd = vector(length = nDays); upBnd = vector(length = nDays); loBnd = vector(length = nDays); test = vector(length = nDays)
for(i in 0:nDays){
  meanBnd[i] = S0*exp((( mean-sigma^2/2 ))*t[i])
  upBnd[i] = S0*exp((( mean-sigma^2/2 ))*t[i] + (sigma * 2.5 * sqrt(t[i])))
  loBnd[i] = S0*exp((( mean-sigma^2/2 ))*t[i] + (sigma * -2.5 * sqrt(t[i])))
}
```


Presentation of the simulation.
```{r}
matplot(S,type='l',col=1:100,ylab='dtelekom Stock $',xlab='Days',main='Simulation')
matlines(loBnd,lwd=3,col="blue")
matlines(upBnd,lwd=3,col="blue")
matlines(meanBnd,lwd=3,col="blue")
```

Calculation of the Longnormal Distribution
```{r}
lnMean = S0*exp(dtelekommean*nDays)
lnSD = S0*exp(dtelekommean*nDays)*sqrt(exp((dtelekomsd^2)*nDays)-1)
```

*Describe*
```{r}
cat('OptionPrice',mean(S[nDays,]))
```

*Describe*
```{r}
cat('Standardabweichung',lnSD,sd(S[nDays,]))
```

Presentation of the Simulation distribution
```{r}
meanOfLog = log(S0) + (dtelekommean-(dtelekomsd^2)/2)*nDays
sdOfLog = dtelekomsd*sqrt(nDays)
priceGrid = seq(0,lnMean+6*lnSD,length=10000)
theoreticalDens = dlnorm(priceGrid,meanOfLog,sdOfLog)
empiricalDens = density(S[nDays,])

plot(priceGrid,theoreticalDens,type='l',xlab='Prices',ylab='Density')
lines(empiricalDens,col='blue')
```
### Options Price put and call
```{r}

```


### Black-Scholes-Model

```{r}

currentStockPrice = S0
sigma = dtelekomsd



```












